[{"_comment": "DO NOT EDIT THIS FILE. THIS WAS AUTOMATICALLY GENERATED BY THE hjson_to_json.py SCRIPT. INSTEAD, EDIT THE osx-config.hjson FILE."}, {"type": "exact match", "confidence": "required", "command": "id -Gn | grep -c -w admin", "expected_stdout": "0", "fix": "# NO FIX AVAILABLE, you must create a new account in System Preferences", "case_sensitive": "false", "description": "Current user is a non-admin account. (Create a new account if this fails!)"}, {"type": "exact match", "confidence": "required", "command": "defaults -currentHost read /Library/Preferences/com.apple.alf globalstate", "expected_stdout": "1", "fix": "defaults -currentHost write /Library/Preferences/com.apple.alf globalstate -bool true", "sudo_fix": "sudo defaults -currentHost write /Library/Preferences/com.apple.alf globalstate -bool true", "case_sensitive": "false", "description": "The OSX application firewall is enabled.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide"}, {"type": "exact match", "confidence": "required", "command": "defaults -currentHost read /Library/Preferences/com.apple.alf loggingenabled", "expected_stdout": "1", "fix": "defaults -currentHost write /Library/Preferences/com.apple.alf loggingenabled -bool true", "sudo_fix": "sudo defaults -currentHost write /Library/Preferences/com.apple.alf loggingenabled -bool true", "case_sensitive": "false", "description": "Logging is enabled for the operating system.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide"}, {"type": "exact match", "confidence": "required", "command": "[[ -n $HOMEBREW_NO_ANALYTICS ]] && echo 1 || echo 0", "expected_stdout": "1", "fix": "grep -q 'export HOMEBREW_NO_ANALYTICS=1' ~/.profile || echo 'export HOMEBREW_NO_ANALYTICS=1' >> ~/.profile ; source ~/.profile", "case_sensitive": "false", "description": "Homebrew analytics are disabled. (NOTE: Fix requires you to login/logout.)", "reference": "https://github.com/Homebrew/brew/blob/master/share/doc/homebrew/Analytics.md"}, {"type": "exact match", "confidence": "recommended", "command": "defaults -currentHost read /Library/Preferences/com.apple.alf stealthenabled", "expected_stdout": "1", "fix": "defaults write /Library/Preferences/com.apple.alf stealthenabled -bool true", "sudo_fix": "sudo defaults write /Library/Preferences/com.apple.alf stealthenabled -bool true", "case_sensitive": "false", "description": "Stealth mode is enabled for OSX: Computer does not respond to ICMP ping requests or connection attempts from a closed TCP/UDP port.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": "sudo defaults write /Library/Preferences/com.apple.alf stealthenabled -bool false"}, {"type": "exact match", "confidence": "required", "command": "defaults -currentHost read /Library/Preferences/com.apple.alf allowsignedenabled", "expected_stdout": "1", "fix": "defaults -currentHost write /Library/Preferences/com.apple.alf allowsignedenabled -bool false", "sudo_fix": "sudo defaults -currentHost write /Library/Preferences/com.apple.alf allowsignedenabled -bool false", "case_sensitive": "false", "description": "Automatic whitelisting of Apple-signed applications for firewall is disabled.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": "sudo defaults -currentHost write /Library/Preferences/com.apple.alf allowsignedenabled -bool true"}, {"type": "exact match", "confidence": "required", "command": "defaults -currentHost read /Library/Preferences/SystemConfiguration/com.apple.captive.control Active", "expected_stdout": "0", "fix": "defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.captive.control Active -bool false", "sudo_fix": "sudo defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.captive.control Active -bool false", "case_sensitive": "false", "description": "Captive portal for connecting to new networks is disabled to prevent MITM attacks.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": "sudo defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.captive.control Active -bool true"}, {"type": "exact match", "confidence": "required", "command": "openssl version", "expected_stdout": "OpenSSL 1.0.2h  3 May 2016", "fix": "brew update ; brew install openssl ; brew upgrade openssl ; brew link openssl --force ; mv /usr/bin/openssl /usr/in/openssl-apple", "sudo_fix": "brew update ; brew install openssl ; brew upgrade openssl ; brew link openssl --force ; sudo mv /usr/bin/openssl /usr/in/openssl-apple", "case_sensitive": "false", "description": "OpenSSL is up-to-date.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": "sudo mv /usr/bin/openssl-apple /usr/bin/openssl ; brew unlink openssl"}, {"type": "exact match", "confidence": "recommended", "command": "defaults -currentHost read /Library/Preferences/SystemConfiguration/com.apple.finder AppleShowAllFiles", "expected_stdout": "1", "fix": "defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.finder AppleShowAllFiles -bool true && killall Dock", "sudo_fix": "sudo defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.finder AppleShowAllFiles -bool true && killall Dock", "case_sensitive": "false", "description": "Hidden files are displayed in Finder.", "reference": "http://lifehacker.com/the-best-hidden-settings-you-can-unlock-with-os-xs-ter-1476627111", "undo": "defaults -currentHost write /Library/Preferences/SystemConfiguration/com.apple.finder AppleShowAllFiles -bool false && killall Dock"}, {"type": "exact match", "confidence": "required", "command": "LASTUPDATE=$(defaults read /Library/Preferences/com.apple.SoftwareUpdate | grep LastSuccessfulDate | sed -e 's@^.* \"\\([0-9\\\\-]*\\) .*$@\\1@'); if [ \"$LASTUPDATE\" = \"$(date +%Y-%m-%d)\" ];then echo 1 && exit; fi; exit 0 && exit", "expected_stdout": "1", "fix": "softwareupdate -i -a", "sudo_fix": "sudo softwareupdate -i -a", "case_sensitive": "false", "description": "All application software is currently up to date.", "reference": "https://github.com/SummitRoute/osxlockdown/"}, {"type": "exact match", "confidence": "required", "command": "softwareupdate --schedule | grep 'Automatic check is on'", "sudo_command": "sudo softwareupdate --schedule | grep 'Automatic check is on'", "expected_stdout": "Automatic check is on", "fix": "softwareupdate --schedule on", "sudo_fix": "sudo softwareupdate --schedule on", "case_sensitive": "false", "description": "Automatic check for software updates is enabled.", "reference": "https://github.com/SummitRoute/osxlockdown/"}, {"type": "regex match", "confidence": "recommended", "command": "pmset -g", "expected_regex": ".*destroyfvkeyonstandby\\s+1.*", "fix": "pmset -a destroyfvkeyonstandby 1", "sudo_fix": "sudo pmset -a destroyfvkeyonstandby 1", "case_sensitive": "false", "description": "The File Vault key is destroyed when going to standby mode.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide"}, {"type": "regex match", "confidence": "recommended", "command": "pmset -g", "expected_regex": ".*hibernatemode\\s+25.*", "fix": "pmset -a hibernatemode 25", "sudo_fix": "sudo pmset -a hibernatemode 25", "case_sensitive": "false", "description": "The system will store a copy of memory to persistent storage, and will remove power to memory.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide"}, {"type": "regex match", "confidence": "required", "command": "git --version", "expected_regex": ".*(command not found|2\\.8\\.2).*", "fix": "brew update && brew install git && brew upgrade git && mv /usr/bin/git /usr/bin/git-apple", "sudo_fix": "brew update && brew install git && brew upgrade git && sudo mv /usr/bin/git /usr/bin/git-apple", "case_sensitive": "false", "description": "git is up to date or is not installed"}, {"type": "regex match", "confidence": "recommended", "command": "launchctl list", "sudo_command": "sudo launchctl list", "expected_regex": "^((?!com\\.apple\\.apsd).)*$", "fix": "launchctl unload -w /System/Library/LaunchDaemons/com.apple.apsd.plist", "sudo_fix": "sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.apsd.plist", "case_sensitive": "false", "description": "Apple Push Notifications are disabled.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": "sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.apsd.plist"}, {"type": "regex match", "confidence": "recommended", "command": "nslookup google.com", "expected_regex": "^.*Server:\\s+8\\.8\\.8\\.8.*", "fix": "networksetup listallnetworkservices | grep -v 'An asterisk' | xargs -I{} networksetup -setdnsservers '{}' 8.8.8.8 8.8.4.4", "case_sensitive": "false", "description": "Google DNS servers are used by default on all network interfaces."}, {"type": "regex match", "confidence": "required", "command": "curl --version", "expected_regex": ".*(command not found|7\\.48\\.0).*", "fix": "brew update ; brew install curl ; brew upgrade curl ; brew link curl --force", "case_sensitive": "false", "description": "The curl utility is up to date or absent from the system.", "undo": "brew unlink curl"}, {"type": "regex match", "confidence": "required", "command": "fdesetup status -verbose", "expected_regex": "^.*FileVault is On.*$", "fix": "#", "case_sensitive": "false", "description": "FileVault file system encryption is enabled.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide", "undo": ""}, {"type": "regex match", "confidence": "required", "command": "fdesetup status -verbose", "expected_regex": "^.*device path \\=\\s+.*$", "fix": "#TODO: None", "case_sensitive": "false", "description": "FileVault file system encrption is enabled at the root directory.", "reference": "https://github.com/drduh/OS-X-Security-and-Privacy-Guide"}]